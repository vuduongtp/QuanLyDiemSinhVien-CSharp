select MASV,HO,TEN,NGAYSINH,TENLOP,TENKH
from (select MASV,MALOP,HO,TEN,NGAYSINH from LINK0.QLDSV.dbo.SINHVIEN where SINHVIEN.MASV='n16cn34') as SV,LINK0.QLDSV.dbo.LOP,LINK0.QLDSV.dbo.KHOA 
where LOP.MALOP=SV.MALOP and KHOA.MAKH=LOP.MAKH

select MAKH 
from LOP,(SELECT MALOP FROM SINHVIEN 
where SINHVIEN.MASV='n16cn34') as SV where LOP.MALOP=SV.MALOP


INSERT INTO LINK1.QLDSV.dbo.SINHVIEN(MASV, HO, TEN, MALOP, PHAI, NGAYSINH, NOISINH, DIACHI, NGHIHOC, GHICHU) 
values(N'Program',N'Program',N'Reader',N'D08VTA1','true',1998-12-12,N'myReade',N'myReade','true',N'yReade')

select HO,TEN,PHAI,NGAYSINH,NOISINH,DIACHI from SINHVIEN where MALOP='D16CQCN1'

declare @row_num int
set @row_num = 1
select MASV,HOTEN=HO+' '+TEN,SOTO='',DIEM='',CHUKY='' 
from SINHVIEN 
where MALOP='D16CQCN1'

SELECT
    TENMH,
    MAX(DIEM) as DIEM
FROM
		MONHOC AS MH
    INNER JOIN 
		(SELECT DIEM,MAMH FROM DIEM WHERE MASV='N16CN99') AS D
        ON MH.MAMH = D.MAMH
GROUP BY
    MH.TENMH
ORDER BY
    MH.TENMH ASC


SELECT HOTEN=HO+' '+TEN,ISNULL(HOCPHI,0) as HOCPHI,ISNULL(SOTIENDADONG,0) as SOTIENDADONG
FROM (SELECT MASV,HO,TEN 
	  FROM SINHVIEN 
	  WHERE MALOP='D08VTA1') AS SV 
	LEFT JOIN 
	  (SELECT MASV,HOCPHI,SOTIENDADONG 
	   FROM HOCPHI 
	   WHERE NIENKHOA=N'2008-2012' AND HOCKY=1) AS HP
	ON SV.MASV=HP.MASV
ORDER BY TEN ASC



CREATE PROCEDURE SP_INHOCPHILOP @MALOP nchar(8), @NIENKHOA nvarchar(12), @HOCKY INT
AS 
SELECT HOTEN=HO+' '+TEN,ISNULL(HOCPHI,0) as HOCPHI,ISNULL(SOTIENDADONG,0) as SOTIENDADONG
FROM (SELECT MASV,HO,TEN 
	  FROM SINHVIEN 
	  WHERE MALOP=@MALOP) AS SV 
	LEFT JOIN 
	  (SELECT MASV,HOCPHI,SOTIENDADONG 
	   FROM HOCPHI 
	   WHERE NIENKHOA=@NIENKHOA AND HOCKY=@HOCKY) AS HP
	ON SV.MASV=HP.MASV
ORDER BY TEN ASC
GO

EXEC SP_INHOCPHILOP @MALOP='D16CQCN1',@NIENKHOA=N'2008-2009',@HOCKY=1


ALTER PROCEDURE [dbo].[SP_INDANHSACHSINHVIEN] @MALOP nchar(8)
AS 
SELECT HO,
	   TEN,
	   PHAI = (CONVERT(NVARCHAR(3), CASE PHAI WHEN 1 THEN N'Nam' ELSE N'Nu' END)),
	   Convert(nvarchar, NGAYSINH, 105)AS NGAYSINH,
	   NOISINH,
	   DIACHI  
FROM SINHVIEN
WHERE MALOP=@MALOP