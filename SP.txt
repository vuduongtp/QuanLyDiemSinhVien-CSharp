CREATE PROCEDURE [dbo].[SP_INDANHSACHSINHVIEN] @MALOP nchar(8)
AS 
SELECT IDENTITY (INT, 1, 1) AS STT,
	   HO,
	   TEN,
	   PHAI = (CONVERT(NVARCHAR(3), CASE PHAI WHEN 1 THEN N'Nam' ELSE N'Ná»¯' END)),
	   Convert(nvarchar, NGAYSINH, 105)AS NGAYSINH,
	   NOISINH,
	   DIACHI 
	INTO #BANGTAM
	FROM SINHVIEN
	WHERE MALOP='D16CQCN1'

select * from #BANGTAM
DROP TABLE #BANGTAM


CREATE PROCEDURE [dbo].[SP_INHOCPHILOP] @MALOP nchar(8), @NIENKHOA nvarchar(12), @HOCKY INT
AS 
SELECT IDENTITY (INT, 1, 1) AS STT,
	   HOTEN=HO+' '+TEN,
	   ISNULL(HOCPHI,0) as HOCPHI,
	   ISNULL(SOTIENDADONG,0) as SOTIENDADONG
INTO #BANGTAM
FROM (SELECT MASV,HO,TEN 
	  FROM SINHVIEN 
	  WHERE MALOP=@MALOP) AS SV 
	LEFT JOIN 
	  (SELECT MASV,HOCPHI,SOTIENDADONG 
	   FROM HOCPHI 
	   WHERE NIENKHOA=@NIENKHOA AND HOCKY=@HOCKY) AS HP
	ON SV.MASV=HP.MASV
ORDER BY TEN ASC

select * from #BANGTAM
DROP TABLE #BANGTAM




CREATE PROCEDURE [dbo].[SP_INPHIEUDIEM] @MASV nchar(8)
AS 
SELECT
    IDENTITY (INT, 1, 1) AS STT,
	TENMH,
    MAX(DIEM) as DIEM
INTO #BANGTAM
FROM
		MONHOC AS MH
    INNER JOIN 
		(SELECT DIEM,MAMH FROM DIEM WHERE MASV=@MASV) AS D
        ON MH.MAMH = D.MAMH
GROUP BY
    MH.TENMH
ORDER BY
    MH.TENMH ASC

select * from #BANGTAM
DROP TABLE #BANGTAM